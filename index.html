<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ultimate AI Game Hub</title>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<!-- Back4App / Parse SDK -->
<script src="https://unpkg.com/parse/dist/parse.min.js"></script>

<style>
body { font-family: Arial, sans-serif; background:#1e1e1e; color:#fff; margin:0; padding:0; }
header { background:#333; padding:20px; text-align:center; }
section { padding:20px; }
h2 { color:#f0f0f0; text-align:center; }
input, button, textarea { padding:10px; margin:5px 0; border-radius:5px; border:none; cursor:pointer; }
#auth-messages { margin-bottom:10px; color:#ffcc00; }
#protectedContent { display:none; }
iframe { width:300px; height:200px; border:none; border-radius:5px; }
#tyreeseMessages { height:250px; overflow-y:auto; background: rgba(0,0,0,0.2); padding:15px; border-radius:10px; font-style:italic; }
.provider-btn { background:#4a90e2; color:white; margin-top:5px; }
.github-btn { background:#333; }
.post-container { background: rgba(0,0,0,0.3); padding:10px; margin:10px 0; border-radius:8px; }
.comment-container { background: rgba(0,0,0,0.2); padding:5px 10px; margin:5px 0; border-radius:5px; font-size:0.9em; }
.like-btn, .follow-btn, .comment-btn { margin:5px; padding:5px 10px; border-radius:5px; cursor:pointer; }
</style>

<script>
  // ---------------- Firebase Config ----------------
  const firebaseConfig = {
    apiKey: "AIzaSyCFQmadEV0ekDEmF23sUu2ZPkpUzbpD7kY",
    authDomain: "yodude-44fdb.firebaseapp.com",
    projectId: "yodude-44fdb",
    storageBucket: "yodude-44fdb.appspot.com",
    messagingSenderId: "421085612215",
    appId: "1:421085612215:web:YOUR_APP_ID_HERE"
  };
  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();

  // ---------------- Back4App Init ----------------
  Parse.initialize("V32Kr6GQj0LknYPynIG8T0MwgEKAcLNxmLEDzauo"); // JS Key
  Parse.serverURL = 'https://parseapi.back4app.com/';
</script>
</head>
<body>

<header>
  <h1>üéÆ Ultimate AI Game Hub</h1>
  <p>Login to access all features!</p>
</header>

<!-- Login / Signup -->
<section id="auth">
  <h2>üîë Login / Signup</h2>
  <div id="auth-messages">üîê Please log in or sign up</div>

  <input type="email" id="email" placeholder="Email" required/>
  <input type="password" id="password" placeholder="Password" required/>
  <button id="signupBtn">Sign Up</button>
  <button id="loginBtn">Login</button>
  <button id="logoutBtn" style="display:none;">Logout</button>

  <hr style="margin:15px 0; border-color:#555;"/>
  <button id="googleBtn" class="provider-btn">Login with Google</button>
  <button id="githubBtn" class="provider-btn github-btn">Login with GitHub</button>
</section>

<!-- Protected Content -->
<div id="protectedContent">

  <!-- Mini Crazy Games -->
  <section id="mini-crazy-games">
    <h2>üéÆ Mini Crazy Games</h2>
    <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:15px;">
      <iframe src="https://www.crazygames.com/embed/moto-x3m" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
      <iframe src="https://www.crazygames.com/embed/shell-shockers" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
      <iframe src="https://www.crazygames.com/embed/krunker-io" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
      <iframe src="https://www.crazygames.com/embed/happy-wheels" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
      <iframe src="https://www.crazygames.com/embed/bloxdhop-io" sandbox="allow-same-origin allow-scripts allow-forms"></iframe>
    </div>
  </section>

  <!-- AI YouTube Launcher -->
  <section id="ai-videos">
    <h2>üé¨ AI YouTube Launcher</h2>
    <div id="video-container" style="display:flex; flex-wrap:wrap; justify-content:center; gap:15px;"></div>
  </section>

  <!-- Tyreese AI Assistant -->
  <section id="tyreese">
    <h2>ü§ò Tyreese - Your Cool AI Assistant</h2>
    <div id="tyreeseMessages"></div>
    <form id="tyreeseForm" style="display:flex; gap:10px; margin-top:10px;">
      <input type="text" id="tyreeseInput" placeholder="Ask Tyreese..." required style="flex:1; padding:10px; border-radius:8px;"/>
      <button type="submit" style="padding:10px 20px; border-radius:8px; background:#4a32a8; color:white;">Send</button>
    </form>
  </section>

  <!-- Social Media Section -->
  <section id="social-media">
    <h2>üìù Social Feed</h2>

    <!-- Create Post -->
    <textarea id="postContent" placeholder="Write a new post..." rows="3" style="width:100%;"></textarea>
    <button id="createPostBtn">Post</button>

    <!-- Feed -->
    <div id="postFeed"></div>
  </section>

</div>

<script>
const authMessages = document.getElementById("auth-messages");
const emailInput = document.getElementById("email");
const passwordInput = document.getElementById("password");
const signupBtn = document.getElementById("signupBtn");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const protectedContent = document.getElementById("protectedContent");

let currentUserUid = null;

// ---------------- Firebase Auth ----------------
signupBtn.addEventListener("click", async () => {
  try {
    await auth.createUserWithEmailAndPassword(emailInput.value, passwordInput.value);
  } catch (error) { authMessages.textContent = "‚ùå Sign up error: " + error.message; }
});

loginBtn.addEventListener("click", async () => {
  try {
    await auth.signInWithEmailAndPassword(emailInput.value, passwordInput.value);
  } catch (error) { authMessages.textContent = "‚ùå Login error: " + error.message; }
});

logoutBtn.addEventListener("click", async () => { await auth.signOut(); });

document.getElementById("googleBtn").addEventListener("click", () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider)
      .catch(error => authMessages.textContent = "‚ùå Google login error: " + error.message);
});

document.getElementById("githubBtn").addEventListener("click", () => {
  const provider = new firebase.auth.GithubAuthProvider();
  auth.signInWithPopup(provider)
      .catch(error => authMessages.textContent = "‚ùå GitHub login error: " + error.message);
});

auth.onAuthStateChanged(user => {
  if(user){
    authMessages.textContent = "‚úÖ Logged in as " + (user.email || user.displayName);
    logoutBtn.style.display = "inline-block";
    protectedContent.style.display = "block";
    currentUserUid = user.uid;
    fetchPosts();
  } else {
    authMessages.textContent = "üîê Please log in or sign up";
    logoutBtn.style.display = "none";
    protectedContent.style.display = "none";
    currentUserUid = null;
  }
});

// ---------------- Tyreese AI ----------------
const tyreeseForm = document.getElementById("tyreeseForm");
const tyreeseInput = document.getElementById("tyreeseInput");
const tyreeseMessages = document.getElementById("tyreeseMessages");

tyreeseForm.addEventListener("submit", e => {
  e.preventDefault();
  const userMsg = tyreeseInput.value;
  const divUser = document.createElement("div");
  divUser.textContent = "You: " + userMsg;
  tyreeseMessages.appendChild(divUser);

  const divAI = document.createElement("div");
  divAI.textContent = "Tyreese: " + generateTyreeseReply(userMsg);
  tyreeseMessages.appendChild(divAI);

  tyreeseInput.value = "";
  tyreeseMessages.scrollTop = tyreeseMessages.scrollHeight;
});

function generateTyreeseReply(msg){
  const responses = [
    "Cool! I like that.",
    "Interesting idea üòé",
    "Hmm, let me think about it...",
    "Haha, that's wild!",
    "I can do that for you!"
  ];
  return responses[Math.floor(Math.random()*responses.length)];
}

// ---------------- Back4App Social Media ----------------
const createPostBtn = document.getElementById("createPostBtn");
const postContent = document.getElementById("postContent");
const postFeed = document.getElementById("postFeed");

createPostBtn.addEventListener("click", async () => {
  if(!currentUserUid) return;
  const content = postContent.value.trim();
  if(!content) return;

  const Post = Parse.Object.extend("Post");
  const post = new Post();
  post.set("authorId", currentUserUid);
  post.set("content", content);
  post.set("createdAt", new Date());

  try{
    await post.save();
    postContent.value = "";
    fetchPosts();
  }catch(err){ alert("Error creating post: "+err.message); }
});

async function fetchPosts(){
  postFeed.innerHTML = "";
  const Post = Parse.Object.extend("Post");
  const query = new Parse.Query(Post);
  query.descending("createdAt");
  const results = await query.find();

  for(const post of results){
    const div = document.createElement("div");
    div.className = "post-container";

    // Fetch author display name from Back4App User class
    const authorQuery = new Parse.Query(Parse.User);
    authorQuery.equalTo("objectId", post.get("authorId"));
    const author = await authorQuery.first();
    const authorName = author ? (author.get("username") || author.get("email")) : "Unknown";

    div.innerHTML = `<strong>${authorName}</strong>: ${post.get("content")}`;

    // Likes
    const Like = Parse.Object.extend("Like");
    const likeBtn = document.createElement("button");
    likeBtn.className = "like-btn";
    likeBtn.textContent = "‚ù§Ô∏è Like";
    likeBtn.addEventListener("click", async () => {
      const like = new Like();
      like.set("user", currentUserUid);
      like.set("post", post);
      like.set("createdAt", new Date());
      await like.save();
      fetchPosts();
    });
    div.appendChild(likeBtn);

    // Comments
    const Comment = Parse.Object.extend("Comment");
    const commentsQuery = new Parse.Query(Comment);
    commentsQuery.equalTo("post", post);
    const comments = await commentsQuery.find();
    comments.forEach(c => {
      const commentDiv = document.createElement("div");
      commentDiv.className = "comment-container";
      commentDiv.textContent = `${c.get("author")} : ${c.get("text")}`;
      div.appendChild(commentDiv);
    });

    const commentInput = document.createElement("input");
    commentInput.placeholder = "Add a comment...";
    const commentBtn = document.createElement("button");
    commentBtn.className = "comment-btn";
    commentBtn.textContent = "Comment";
    commentBtn.addEventListener("click", async () => {
      const text = commentInput.value.trim();
      if(!text) return;
      const comment = new Comment();
      comment.set("author", currentUserUid);
      comment.set("post", post);
      comment.set("text", text);
      comment.set("createdAt", new Date());
      await comment.save();
      fetchPosts();
    });
    div.appendChild(commentInput);
    div.appendChild(commentBtn);

    postFeed.appendChild(div);
  }
}

// ---------------- AI YouTube Launcher (Demo) ----------------
const videoContainer = document.getElementById("video-container");
const categories = {
  funny:["https://www.youtube.com/embed/tgbNymZ7vqY","https://www.youtube.com/embed/5qap5aO4i9A"],
  anime:["https://www.youtube.com/embed/s7L2PVdrb_8","https://www.youtube.com/embed/2Vv-BfVoq4g"],
  weird:["https://www.youtube.com/embed/3JZ_D3ELwOQ","https://www.youtube.com/embed/L_jWHffIx5E"],
  dark:["https://www.youtube.com/embed/e-ORhEE9VVg","https://www.youtube.com/embed/kXYiU_JCYtU"],
  disney:["https://www.youtube.com/embed/QtXby3twMmI","https://www.youtube.com/embed/YQHsXMglC9A"]
};
for(let cat in categories){
  categories[cat].forEach(url => {
    const iframe = document.createElement("iframe");
    iframe.src = url;
    videoContainer.appendChild(iframe);
  });
}
</script>
</body>
</html>