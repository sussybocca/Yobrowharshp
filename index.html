<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Yodude Universe</title>
  <script type="module" src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/10.4.0/firebase-functions.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #ai-response, #tyreese-response, #gamble-result { margin-top: 10px; white-space: pre-wrap; }
    iframe { border: none; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Yodude Universe</h1>

  <!-- LOGIN -->
  <div id="auth-section">
    <input id="email" placeholder="Email" />
    <input id="password" type="password" placeholder="Password" />
    <button id="signup-btn">Sign Up</button>
    <button id="signin-btn">Sign In</button>
    <button id="google-btn">Sign In with Google</button>
    <button id="github-btn">Sign In with GitHub</button>
    <div id="auth-messages"></div>
    <button id="logout-btn" style="display:none;">Logout</button>
  </div>

  <!-- PROTECTED CONTENT -->
  <div id="protected-content" style="display:none;">

    <!-- VERTEX AI CHAT -->
    <h2>Vertex AI Chat</h2>
    <input id="ai-input" placeholder="Ask AI anything..." />
    <button onclick="sendAI()">Send</button>
    <div id="ai-response"></div>

    <!-- TYREESE AI -->
    <h2>Tyreese AI Chat</h2>
    <input id="tyreese-input" placeholder="Talk to Tyreese" />
    <button onclick="talkTyreese()">Send</button>
    <div id="tyreese-response"></div>

    <!-- MINI GAMES -->
    <h2>Mini Crazy Games</h2>
    <iframe src="https://www.crazygames.com/" width="800" height="600"></iframe>

    <!-- AI YOUTUBE LAUNCHER -->
    <h2>AI YouTube Launcher</h2>
    <div id="ai-youtube">
      <button onclick="playCategory('funny')">Funny</button>
      <button onclick="playCategory('anime')">Anime</button>
      <button onclick="playCategory('weird')">Weird</button>
      <button onclick="playCategory('dark')">Dark</button>
      <button onclick="playCategory('disney conspiracy theories')">Disney Conspiracies</button>
      <div id="youtube-video"></div>
    </div>

    <!-- MARKETPLACE -->
    <h2>Marketplace</h2>
    <button onclick="buyItem('Car')">Buy Car ($50k)</button>
    <button onclick="buyItem('House')">Buy House ($200k)</button>
    <p>Your Money: <span id="money-display">0</span></p>

    <!-- GAMBLING -->
    <h2>Gambling</h2>
    <input type="number" id="gamble-amount" placeholder="Gamble Points">
    <button onclick="playSlot()">Play Slot</button>
    <p>Gambling Points: <span id="gambling-display">0</span></p>
    <p id="gamble-result"></p>

  </div>

  <script type="module">
    // Firebase JS SDK v7.20.0+ (measurementId optional)
    const firebaseConfig = {
      apiKey: "AIzaSyCFQmadEV0ekDEmF23sUu2ZPkpUzbpD7kY",
      authDomain: "yodude-44fdb.firebaseapp.com",
      databaseURL: "https://yodude-44fdb-default-rtdb.firebaseio.com",
      projectId: "yodude-44fdb",
      storageBucket: "yodude-44fdb.firebasestorage.app",
      messagingSenderId: "421085612215",
      appId: "1:421085612215:web:39232725a276e3b2dd2532",
      measurementId: "G-WHM50CY06L"
    };

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, GoogleAuthProvider, GithubAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
    import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-functions.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const functions = getFunctions(app);
    const db = getFirestore(app);

    const signupBtn = document.getElementById("signup-btn");
    const signinBtn = document.getElementById("signin-btn");
    const logoutBtn = document.getElementById("logout-btn");
    const googleBtn = document.getElementById("google-btn");
    const githubBtn = document.getElementById("github-btn");
    const authMessages = document.getElementById("auth-messages");
    const protectedContent = document.getElementById("protected-content");

    let currentUserUid = null;
    let userData = { money: 0, gamblingPoints: 0 };

    // EMAIL SIGNUP
    signupBtn.onclick = async () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      try { await createUserWithEmailAndPassword(auth, email, password); }
      catch(err){ authMessages.textContent = err.message; }
    };

    // EMAIL SIGNIN
    signinBtn.onclick = async () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      try { await signInWithEmailAndPassword(auth, email, password); }
      catch(err){ authMessages.textContent = err.message; }
    };

    // GOOGLE LOGIN
    googleBtn.onclick = async () => {
      const provider = new GoogleAuthProvider();
      try { await signInWithPopup(auth, provider); } 
      catch(err){ authMessages.textContent = err.message; }
    };

    // GITHUB LOGIN
    githubBtn.onclick = async () => {
      const provider = new GithubAuthProvider();
      try { await signInWithPopup(auth, provider); } 
      catch(err){ authMessages.textContent = err.message; }
    };

    // LOGOUT
    logoutBtn.onclick = async () => { await signOut(auth); };

    // AUTH STATE
    onAuthStateChanged(auth, async user => {
      if(user){
        currentUserUid = user.uid;
        protectedContent.style.display = "block";
        logoutBtn.style.display = "inline-block";
        authMessages.textContent = "Logged in as: " + (user.email || user.displayName);

        const userRef = doc(db, "users", user.uid);
        const docSnap = await getDoc(userRef);
        if(!docSnap.exists()){
          await setDoc(userRef, { money: 100000, gamblingPoints: 1000 });
          userData = { money: 100000, gamblingPoints: 1000 };
        } else { userData = docSnap.data(); }
        updateDisplays();
      } else {
        protectedContent.style.display = "none";
        logoutBtn.style.display = "none";
        authMessages.textContent = "Please log in.";
      }
    });

    function updateDisplays(){
      document.getElementById("money-display").innerText = userData.money;
      document.getElementById("gambling-display").innerText = userData.gamblingPoints;
    }

    // VERTEX AI
    async function sendAI(){
      const prompt = document.getElementById("ai-input").value;
      if(!prompt) return;
      const queryVertexAI = httpsCallable(functions, "queryVertexAI");
      const response = await queryVertexAI({ prompt });
      document.getElementById("ai-response").innerText = response.data.error || response.data.result;
    }

    // TYREESE AI
    async function talkTyreese(){
      const prompt = document.getElementById("tyreese-input").value;
      if(!prompt) return;
      const queryVertexAI = httpsCallable(functions, "queryVertexAI");
      const response = await queryVertexAI({ prompt: "Tyreese style: " + prompt });
      document.getElementById("tyreese-response").innerText = response.data.error || response.data.result;
    }

    // AI YOUTUBE LAUNCHER
    function playCategory(category){
      const ytDiv = document.getElementById("youtube-video");
      ytDiv.innerHTML = `<iframe width="560" height="315" src="https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(category)}+AI" allowfullscreen></iframe>`;
    }

    // MARKETPLACE
    async function buyItem(itemName){
      const prices = { "Car": 50000, "House": 200000 };
      const price = prices[itemName];
      if(userData.money >= price){
        userData.money -= price;
        await updateDoc(doc(db, "users", currentUserUid), { money: userData.money });
        updateDisplays();
        alert(`You bought a ${itemName}!`);
      } else alert("Not enough money!");
    }

    // GAMBLING
    async function playSlot(){
      const amount = parseInt(document.getElementById("gamble-amount").value);
      if(amount > userData.gamblingPoints) return alert("Not enough points!");
      userData.gamblingPoints -= amount;

      const rand = Math.random() * 100;
      let winAmount = 0;
      if(rand <= 1){ winAmount = 1000000; } // Big Jackpot
      else if(rand <= 12){ winAmount = 90000; }
      else if(rand <= 32){ winAmount = 30000; }
      else { winAmount = 0; }

      userData.gamblingPoints += winAmount;
      await updateDoc(doc(db, "users", currentUserUid), { gamblingPoints: userData.gamblingPoints });
      updateDisplays();
      document.getElementById("gamble-result").innerText = winAmount > 0 ? `You won ${winAmount} points!` : "You lost!";
    }
  </script>
</body>
</html>
